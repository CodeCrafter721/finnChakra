<mat-sidenav-container class="dashboard-container" [class.dark-theme]="isDark">
  <!-- Side Navigation -->
  <mat-sidenav
    #drawer
    mode="side"
    [opened]="!collapsed"
    class="dashboard-sidenav"
    [class.collapsed]="collapsed"
    (mouseenter)="hoverSidenav(true)"
    (mouseleave)="hoverSidenav(false)"
  >
    <mat-toolbar class="sidenav-header">
      {{ collapsed && !isHovered ? 'âš¡' : 'FinnChakra' }}
    </mat-toolbar>

    <mat-nav-list>
      <a
        mat-list-item
        routerLink="/dashboard/analytics"
        routerLinkActive="active-link"
        matTooltip="Analytics"
        matTooltipPosition="right"
        [matTooltipDisabled]="!collapsed"
      >
        <mat-icon>bar_chart</mat-icon>
        <span *ngIf="!collapsed || isHovered">Analytics</span>
      </a>

      <a
        mat-list-item
        routerLink="/dashboard/transaction-analytics"
        routerLinkActive="active-link"
        matTooltip="Txn Analytics"
        matTooltipPosition="right"
        [matTooltipDisabled]="!collapsed"
      >
        <mat-icon>analytics</mat-icon>
        <span *ngIf="!collapsed || isHovered">Txn Analytics</span>
      </a>

      <a
        mat-list-item
        routerLink="/dashboard/budgets"
        routerLinkActive="active-link"
        matTooltip="Budgets"
        matTooltipPosition="right"
        [matTooltipDisabled]="!collapsed"
      >
        <mat-icon>account_balance_wallet</mat-icon>
        <span *ngIf="!collapsed || isHovered">Budgets</span>
      </a>

      <a
        mat-list-item
        routerLink="/dashboard/transactions"
        routerLinkActive="active-link"
        matTooltip="Transactions"
        matTooltipPosition="right"
        [matTooltipDisabled]="!collapsed"
      >
        <mat-icon>receipt</mat-icon>
        <span *ngIf="!collapsed || isHovered">Transactions</span>
      </a>
    </mat-nav-list>

    <div class="sidenav-footer">
      <button
        mat-icon-button
        class="collapse-btn"
        aria-label="Toggle sidebar"
        (click)="toggleCollapse()"
      >
        <mat-icon>{{ collapsed ? 'chevron_right' : 'chevron_left' }}</mat-icon>
      </button>
    </div>
  </mat-sidenav>

  <!-- Main Content -->
  <mat-sidenav-content class="content-wrapper">
    <mat-toolbar class="topbar" color="primary">
      <!-- Left side -->
      <div class="toolbar-left">
        <button
          mat-icon-button
          aria-label="Toggle sidebar"
          (click)="toggleCollapse()"
          matTooltip="Toggle sidebar"
        >
          <mat-icon>menu</mat-icon>
        </button>
        <span class="toolbar-title">Hi, {{ userName }} ðŸ‘‹</span>
      </div>

      <!-- Right side -->
      <div class="toolbar-right">
        <button
          mat-icon-button
          matBadge="2"
          matBadgeColor="accent"
          [matMenuTriggerFor]="notifMenu"
          matTooltip="Notifications"
        >
          <mat-icon>notifications</mat-icon>
        </button>
        <mat-menu #notifMenu="matMenu">
          <button mat-menu-item><mat-icon>info</mat-icon> Budget limit approaching</button>
          <button mat-menu-item><mat-icon>star</mat-icon> New analytics available</button>
        </mat-menu>

        <button mat-icon-button (click)="toggleTheme()" matTooltip="Toggle theme">
          <mat-icon>{{ isDark ? 'light_mode' : 'dark_mode' }}</mat-icon>
        </button>

        <button mat-button [matMenuTriggerFor]="profileMenu" class="profile-btn">
          <mat-icon>account_circle</mat-icon>
          <span *ngIf="!collapsed || isHovered">{{ userEmail }}</span>
        </button>
        <mat-menu #profileMenu="matMenu">
          <button mat-menu-item (click)="logout()">
            <mat-icon>logout</mat-icon>Logout
          </button>
        </mat-menu>
      </div>
    </mat-toolbar>

    <main class="main-content">
      <ng-container *ngIf="isLoading; else loaded">
        <div class="loader-container">
          <div class="spinner"></div>
          <p>Loading your dashboard...</p>
        </div>
      </ng-container>

      <ng-template #loaded>
        <router-outlet></router-outlet>
      </ng-template>
    </main>
  </mat-sidenav-content>
</mat-sidenav-container>
