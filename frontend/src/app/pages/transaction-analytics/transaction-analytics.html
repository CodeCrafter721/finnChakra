<h2>Transaction Analytics</h2>

<div class="filters">
  <mat-form-field>
    <input matInput placeholder="Category" [(ngModel)]="category" (ngModelChange)="onFilterChange()" />
  </mat-form-field>

  <mat-form-field>
    <input matInput type="number" placeholder="Min Amount" [(ngModel)]="minAmount" (ngModelChange)="onFilterChange()" />
  </mat-form-field>

  <mat-form-field>
    <input matInput type="number" placeholder="Max Amount" [(ngModel)]="maxAmount" (ngModelChange)="onFilterChange()" />
  </mat-form-field>

  <mat-form-field>
    <input matInput [matDatepicker]="picker1" placeholder="Start Date" [(ngModel)]="startDate" (dateChange)="onFilterChange()" />
    <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
    <mat-datepicker #picker1></mat-datepicker>
  </mat-form-field>

  <mat-form-field>
    <input matInput [matDatepicker]="picker2" placeholder="End Date" [(ngModel)]="endDate" (dateChange)="onFilterChange()" />
    <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
    <mat-datepicker #picker2></mat-datepicker>
  </mat-form-field>
</div>

<table mat-table [dataSource]="transactions" class="mat-elevation-z8">
  <ng-container matColumnDef="category">
    <th mat-header-cell *matHeaderCellDef>Category</th>
    <td mat-cell *matCellDef="let row">{{ row.category }}</td>
  </ng-container>

  <ng-container matColumnDef="amount">
    <th mat-header-cell *matHeaderCellDef>Amount</th>
    <td mat-cell *matCellDef="let row">â‚¹{{ row.amount }}</td>
  </ng-container>

  <ng-container matColumnDef="date">
    <th mat-header-cell *matHeaderCellDef>Date</th>
    <td mat-cell *matCellDef="let row">{{ row.date | date: 'shortDate' }}</td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
  <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
</table>

<div class="pagination-controls">
  <button mat-button (click)="goToPage(currentPage - 1)" [disabled]="currentPage === 0">Previous</button>
  <span>Page {{ currentPage + 1 }} of {{ totalPages }}</span>
  <button mat-button (click)="goToPage(currentPage + 1)" [disabled]="currentPage + 1 >= totalPages">Next</button>
</div>

<div class="actions">
  <button mat-raised-button color="primary" (click)="exportCSV()">ðŸ“„ Export Table CSV</button>
  <button mat-raised-button (click)="toggleChart()">
    {{ chartVisible ? 'Hide' : 'Show' }} Chart
  </button>
</div>

<div *ngIf="chartVisible" id="chartContainer" style="margin-top: 20px;">
  <apx-chart
    [series]="chartOptions.series"
    [chart]="chartOptions.chart"
    [xaxis]="chartOptions.xaxis">
  </apx-chart>

  <div class="export-chart-buttons" style="margin-top: 10px;">
    <button mat-button color="accent" (click)="exportChartAsImage()">ðŸ“· Export Image</button>
    <button mat-button color="accent" (click)="exportChartAsPDF()">ðŸ“„ Export PDF</button>
  </div>
</div>
